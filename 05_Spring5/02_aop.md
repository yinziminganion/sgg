# aop

## 基本概念

面向切面编程，利用aop可以对业务逻辑的各个部分进行隔离，从而使得业务逻辑各部分之间的耦合度降低，提高程序的可重用性，提高开发效率

通俗描述就是不通过修改源代码的方式，在主干功能里添加新的功能

## 底层原理

动态代理

1. 有接口的情况，使用JDK动态代理，创建接口实现类的代理对象，增强类的方法

2. 没接口的情况，使用CGLIB动态代理，创建当前类子类的代理对象，增强类的方法

## 术语

1. 连接点：类里的哪些方法可以被增强，这些方法就被称为连接点

2. 切入点：实际被增强的方法，成为切入点

3. 通知（增强）：实际增强的逻辑部分成为通知（增强）
    - 前置通知
    - 后置通知
    - 环绕通知
    - 异常通知
    - 最终通知

4. 切面：把通知应用到切入点的过程

## 操作

1. Spring框架中一般基于AspectJ实现aop操作
2. 步骤
    - 引入AspectJ依赖
    - 切入点表达式：知道对哪个类里面的哪个方法进行增强。
      execution&#40;&#91;权限修饰符&#93;&#91;返回类型&#93;&#91;类全路径&#93;&#91;方法名称&#93;&#40;&#91;参数列表&#93;&#41;&#41;
3. 举例
    - execution(* com.xxx.BookDao.add(..))
    - execution(* com.xxx.BookDao.*(..))
    - execution(* com.xxx.dao.&#42;.&#42;(..))
4. 步骤
    1. 创建类，在类里面定义方法
    2. 创建增强类（编写增强逻辑）：在增强类中创建方法，让不同方法代表不同通知类型
    3. 进行通知的配置：①配置注解扫描②使用注解创建User和UserProxy对象③在增强类上添加注解@Aspect④在spring配置中开启生成代理对象
    4. 优先级设置：@Order（值）值越小则优先级越高






